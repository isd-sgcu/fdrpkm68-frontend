---
import Layout from "@/layouts/firstdate/WithoutNavbar.astro";
---

<Layout>
  <div class="relative">
    <div class="flex min-h-screen items-center justify-center px-8">
      {/* Corner brackets */}
      <div
        class="absolute top-6 left-6 h-6 w-6 border-t-2 border-l-2 border-white"
      >
      </div>
      <div
        class="absolute top-6 right-6 h-6 w-6 border-t-2 border-r-2 border-white"
      >
      </div>
      <div
        class="absolute bottom-6 left-6 h-6 w-6 border-b-2 border-l-2 border-white"
      >
      </div>
      <div
        class="absolute right-6 bottom-6 h-6 w-6 border-r-2 border-b-2 border-white"
      >
      </div>

      <div class="flex flex-col items-center">
        <div class="mb-2 flex flex-col items-center">
          <img
            src="/firstdate/register/sgcu-logo.png"
            alt="SGCU Logo"
            class="h-10"
          />
          <img
            src="/firstdate/register/freshmen-fest-logo.png"
            alt="Freshmen Fest Logo"
            class="w-4/5 max-w-sm"
          />
        </div>

        <svg
          width="10"
          height="300"
          viewBox="0 0 10 300"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="mb-2"
        >
          <circle cx="5" cy="5" r="5" fill="white"></circle>
          <line x1="5" y1="10" x2="5" y2="250" stroke="white" stroke-width="2"
          ></line>
          <circle cx="5" cy="255" r="5" fill="white"></circle>
        </svg>

        <button
          class="mb-4 w-full max-w-sm rounded-md bg-white px-6 py-3 text-base font-medium text-black transition duration-200"
          onclick="window.location.href='/register'"
        >
          ลงทะเบียน
        </button>

        <div class="mb-4 text-center">
          <p class="mb-2 text-sm">เคยลงทะเบียนมาแล้ว?</p>
          <button class="underline" onclick="window.location.href='/login'">
            เข้าสู่ระบบ
          </button>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script>
  // Track 8K image load time using Performance API
  const bgImage = document.getElementById("bg-image") as HTMLImageElement;
  const imageLoadTimeElement = document.getElementById("image-load-time");
  const apiLoadTimeElement = document.createElement("span");
  apiLoadTimeElement.className = "text-green-400";

  function checkResourceTimings() {
    // Get image network timing
    const imageUrl = bgImage?.src;
    if (imageUrl) {
      const imagePerfEntries = performance.getEntriesByName(imageUrl);
      if (imagePerfEntries.length > 0) {
        const imageEntry = imagePerfEntries[0] as PerformanceResourceTiming;
        const imageNetworkTime = Math.round(imageEntry.duration);
        if (imageLoadTimeElement) {
          imageLoadTimeElement.textContent = `${imageNetworkTime}ms`;
        }
      }
    }

    // Get API network timing - make a client-side call to measure
    fetch("https://dev.freshmenfest2025.com/api/health").then(() => {
      const apiPerfEntries = performance.getEntriesByName(
        "https://dev.freshmenfest2025.com/api/health"
      );
      if (apiPerfEntries.length > 0) {
        const apiEntry = apiPerfEntries[
          apiPerfEntries.length - 1
        ] as PerformanceResourceTiming;
        const apiNetworkTime = Math.round(apiEntry.duration);
        // Update API load time display
        const apiLoadTimeSpan = document.querySelector("span.text-green-400");
        if (apiLoadTimeSpan && apiLoadTimeSpan.textContent?.includes("ms")) {
          apiLoadTimeSpan.textContent = `${apiNetworkTime}ms (network)`;
        }
      }
    });
  }

  // Check timings after page load
  if (document.readyState === "complete") {
    setTimeout(checkResourceTimings, 100);
  } else {
    window.addEventListener("load", () => {
      setTimeout(checkResourceTimings, 100);
    });
  }
</script>
